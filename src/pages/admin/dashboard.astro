---
import AdminLayout from '../../layouts/AdminLayout.astro';
import { Dashboard } from '../../components/dashboard/Dashboard';
import {
  getTotalSalesMonth,
  getPendingOrdersCount,
  getTopSellingProduct,
  getReturnRate,
  getSalesLast7Days,
  getTopProducts,
  getOrderStatusDistribution,
} from '../../lib/dashboard';

// Fetch all dashboard data
const [
  totalSalesMonth,
  pendingOrders,
  topProduct,
  returnRate,
  salesLast7Days,
  topProducts,
  orderStatusDistribution,
] = await Promise.all([
  getTotalSalesMonth(),
  getPendingOrdersCount(),
  getTopSellingProduct(),
  getReturnRate(),
  getSalesLast7Days(),
  getTopProducts(),
  getOrderStatusDistribution(),
]);
---

<AdminLayout title="Dashboard Ejecutivo">
  <div class="space-y-8 bg-white">
    <!-- Header -->
    <div class="relative bg-gradient-to-r from-pink-200 via-pink-100 to-white border-b-8 border-black px-8 py-12">
      <div class="max-w-7xl mx-auto">
        <h1 class="text-5xl md:text-6xl font-black text-black tracking-tight mb-4">
          ANALYTICS
        </h1>
        <p class="text-lg text-gray-700 font-semibold">Gestión integral de ventas, pedidos y desempeño</p>
        <div class="mt-6 flex gap-2">
          <div class="h-2 w-12 bg-black rounded-full"></div>
          <div class="h-2 w-8 bg-gradient-to-r from-pink-400 to-pink-600 rounded-full"></div>
        </div>
      </div>
    </div>

    {/* Dashboard Content */}
    <div class="px-8 pb-8">
      <Dashboard
        client:load
        totalSalesMonth={totalSalesMonth}
        pendingOrders={pendingOrders}
        topProduct={topProduct}
        returnRate={returnRate}
        salesLast7Days={salesLast7Days}
        topProducts={topProducts}
        orderStatusDistribution={orderStatusDistribution}
      />
    </div>
  </div>
</AdminLayout>
