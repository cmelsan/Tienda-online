ğŸš€ ACTIVACIÃ“N RÃPIDA - 5 MINUTOS

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 1: Ejecutar SQL (2 min)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Ve a: https://supabase.com/dashboard/project/YOUR_PROJECT_ID/sql
2. Click: "New Query" (arriba a la derecha)
3. Borra cualquier texto
4. Copia ABSOLUTAMENTE TODO esto:
   â””â”€ rpc_admin_post_sale.sql (archivo en tu proyecto)
5. Pega en el editor de Supabase
6. Click: "RUN" (arriba a la derecha, botÃ³n verde)
7. Espera 3-5 segundos
8. Verifica que aparezca: "Query executed successfully" âœ“

Si ves error â†’ Revisa que hayas copiado TODO el archivo completo

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 2: Verificar .env.local (1 min)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Abre tu .env.local y verifica que tengas:

    SUPABASE_URL=https://xxxxxxx.supabase.co
    SUPABASE_ANON_KEY=eyXxxxxxx...
    SUPABASE_SERVICE_ROLE_KEY=eyXxxxxxx... â† CRÃTICO

Si no tienes SERVICE_ROLE_KEY:
  1. Ve a Supabase Settings â†’ API Keys
  2. Copia la "service_role" key
  3. PÃ©gala en .env.local como SUPABASE_SERVICE_ROLE_KEY

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 3: Build & Test (1 min)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

En terminal:

    npm run build

Verifica: "Complete!" sin errores

    npm run dev

Verifica: "ready in X ms" sin errores

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 4: Prueba en browser (1 min)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Ve a: http://localhost:3000/admin/pedidos

2. Busca un pedido con status "Pagado" (paid)

3. En la Ãºltima columna (Actions), verÃ¡s:
   â”œâ”€ Badge verde: "Pagado"
   â”œâ”€ BotÃ³n: "ğŸ“¦ Marcar Enviado"
   â””â”€ BotÃ³n: "âŒ Cancelar Pedido"

4. Click en "âŒ Cancelar Pedido"
   â†’ Debe aparecer un MODAL de confirmaciÃ³n

5. AÃ±ade notas (opcional) y haz click "Confirmar"

6. Espera 2-3 segundos

7. Verifica:
   âœ… NotificaciÃ³n de Ã©xito
   âœ… Badge cambiÃ³ a rojo: "Cancelado"
   âœ… Los botones desaparecieron

8. Ve a Supabase Dashboard:
   â†’ "order_status_history" tabla
   â†’ Busca tu order_id
   â†’ Verifica: to_status = 'cancelled' âœ“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 5: Verificar stock restaurado (1 min)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Ve a Supabase: table "products"

2. Busca los productos de ese pedido

3. Verifica que el stock aumentÃ³:
   â””â”€ Si pedido tenÃ­a 2x Producto X:
      stock de Producto X debe haber +2

4. âœ… Â¡TODO FUNCIONA!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

LISTO. Ya estÃ¡ en producciÃ³n.

Git:
    git add .
    git commit -m "feat: admin post-sale management system"
    git push

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TROUBLESHOOTING RÃPIDO

âŒ Build falla
   â†’ Abre src/components/admin/AdminOrderActions.tsx
   â†’ Verifica que tenga "import { useState, ... }"
   â†’ npm run build nuevamente

âŒ Error 500 en API
   â†’ Verifica que SUPABASE_SERVICE_ROLE_KEY estÃ© en .env.local
   â†’ Verifica que el usuario sea admin (profiles.is_admin = true)
   â†’ Revisa Supabase logs

âŒ Botones no aparecen
   â†’ Pedido debe estar en status 'paid'
   â†’ Abre DevTools (F12) â†’ verifica no hay console errors
   â†’ Recarga la pÃ¡gina

âŒ Stock no se restaura
   â†’ Verifica que las RPC functions existan en Supabase
   â†’ Ejecuta rpc_admin_post_sale.sql nuevamente
   â†’ Verifica en order_status_history que haya registro

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Â¿PROBLEMAS? Lee estos archivos EN ORDEN:

1. SISTEMA_POST_VENTA_RESUMEN.md     (Resumen tÃ©cnico)
2. ADMIN_POST_SALE_SETUP.md          (Setup detallado)
3. MATRIZ_VALIDACION_BUGS.md         (Evitar bugs)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
