---
import PublicLayout from '@/layouts/PublicLayout.astro';
import ProductCard from '@/components/product/ProductCard.astro';
import { supabase } from '@/lib/supabase';

// Fetch latest products for slider
const { data: newProducts } = await supabase
  .from('products')
  .select('*, brand:brands(name)')
  .order('created_at', { ascending: false })
  .limit(8);

const { data: brands } = await supabase
  .from('brands')
  .select('*')
  .limit(6);
---

<PublicLayout title="√âCLAT - Perfumes, Maquillaje, Tratamiento" description="Descubre lo √∫ltimo en belleza: maquillaje, tratamiento, perfumes y cabello.">
  
  {/* 1. HERO CAROUSEL: "The Next Big Thing" Style */}
  <section class="relative w-full h-[500px] md:h-[600px] bg-gray-100 overflow-hidden cursor-pointer group">
    <img src="https://res.cloudinary.com/REEMPLAZA_AQUI/image/upload/v123/eclat-beauty/banners/hero-banner.jpg" alt="Hero Campaign" class="w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105" />
    <div class="absolute inset-0 bg-gradient-to-r from-black/20 to-transparent"></div>
    <div class="absolute bottom-12 md:bottom-20 left-6 md:left-20 max-w-lg text-white">
        <h2 class="text-4xl md:text-6xl font-bold uppercase tracking-tight mb-4 leading-none">The Next<br/>Big Thing</h2>
        <p class="text-lg md:text-xl font-medium mb-8">Descubre la nueva revoluci√≥n en cuidado de la piel. Solo en √âclat.</p>
        <a href="/productos" class="inline-block bg-white text-black px-8 py-3 font-bold uppercase tracking-widest text-sm hover:bg-black hover:text-white transition-colors">
            Descubrir
        </a>
    </div>
  </section>

  {/* 2. DOUBLE BANNER GRID (Rebajas / Novedades) */}
  <section class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {/* Banner 1: Rebajas */}
        <div class="relative h-[300px] md:h-[400px] bg-[#ffecf0] flex items-center justify-center overflow-hidden group cursor-pointer">
             <div class="text-center z-10 p-6">
                <h3 class="text-3xl md:text-5xl font-bold uppercase tracking-tight text-beauty-red mb-2">Rebajas</h3>
                <p class="text-black font-bold text-lg mb-6">Hasta -50% en favoritos</p>
                <a href="/ofertas" class="inline-block border-b-2 border-black text-black font-bold uppercase tracking-widest text-xs pb-1 hover:text-beauty-red hover:border-beauty-red transition-colors">
                    Ver Ofertas
                </a>
             </div>
             {/* Decorational element */}
             <div class="absolute -right-10 -bottom-10 w-48 h-48 bg-beauty-red/10 rounded-full blur-3xl"></div>
        </div>

        {/* Banner 2: Novedades */}
        <div class="relative h-[300px] md:h-[400px] bg-gray-100 overflow-hidden group cursor-pointer">
            <img src="https://res.cloudinary.com/REEMPLAZA_AQUI/image/upload/v456/eclat-beauty/banners/novedades-banner.jpg" alt="Novedades" class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" />
            <div class="absolute inset-0 bg-black/10 group-hover:bg-black/20 transition-colors"></div>
             <div class="absolute bottom-8 left-8 text-white">
                <h3 class="text-3xl font-bold uppercase tracking-tight mb-2">Novedades</h3>
                <p class="font-medium mb-6">Lo √∫ltimo de tus marcas favoritas</p>
                <a href="/productos" class="bg-white text-black px-6 py-2 font-bold uppercase tracking-widest text-xs hover:bg-black hover:text-white transition-colors">
                    Comprar
                </a>
             </div>
        </div>
    </div>
  </section>

  {/* 3. PRODUCT SLIDER: "Reci√©n aterrizados" */}
  <section class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="flex items-center justify-between mb-8">
        <h2 class="text-2xl font-bold uppercase tracking-widest">Reci√©n aterrizados</h2>
        <a href="/productos" class="text-sm font-bold border-b border-black pb-0.5 hover:text-gray-600 transition-colors">Ver todo</a>
    </div>
    
    {/* Horizontal Scroll Container */}
    <div class="flex overflow-x-auto gap-6 pb-8 snap-x scrollbar-hide">
        {newProducts?.map(product => (
            <div class="min-w-[200px] md:min-w-[280px] snap-start">
               <ProductCard product={{
                   ...product,
                   brand: product.brand?.name || 'Marca'
               }} />
            </div>
        ))}
    </div>
  </section>

  {/* 4. BRAND SPOTLIGHT (Mosaic) */}
  <section class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-12 bg-black text-white">
    <div class="text-center mb-12">
        <h2 class="text-3xl font-bold uppercase tracking-tight mb-2">Marcas Estrella</h2>
        <p class="text-gray-400">Las marcas de las que todo el mundo habla</p>
    </div>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        {['Rare Beauty', 'Fenty Beauty', 'Dior', 'Charlotte Tilbury'].map((brand, i) => (
            <div class={`relative h-64 md:h-96 bg-gray-900 group overflow-hidden cursor-pointer ${i === 0 ? 'md:col-span-2' : ''}`}>
                {/* Placeholder visual if no image */}
                <div class="absolute inset-0 flex items-center justify-center bg-gray-800 text-gray-700 font-bold text-4xl uppercase opacity-20 group-hover:opacity-10 transition-opacity">
                    {brand}
                </div>
                
                <div class="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black to-transparent">
                    <h3 class="text-xl font-bold uppercase tracking-widest mb-2">{brand}</h3>
                    <span class="text-xs font-bold border-b border-white pb-1">Descubrir marca</span>
                </div>
            </div>
        ))}
    </div>
  </section>

  {/* 5. EXCLUSIVES BANNER */}
  <section class="py-12">
      <div class="relative h-[400px] w-full bg-[#f5f5f5] flex items-center">
         <div class="max-w-[1920px] mx-auto px-4 w-full grid grid-cols-1 md:grid-cols-2">
            <div class="order-2 md:order-1 flex flex-col justify-center items-start md:pl-20">
                <span class="text-beauty-red font-bold uppercase tracking-widest text-xs mb-4">Solo en √âclat</span>
                <h2 class="text-4xl md:text-5xl font-bold uppercase tracking-tight mb-6">√âclat Collection</h2>
                <p class="text-gray-600 max-w-md mb-8">Descubre nuestra propia l√≠nea de maquillaje, dise√±ada para realzar tu belleza natural con f√≥rmulas premium.</p>
                <a href="/marcas/eclat-collection" class="bg-black text-white px-8 py-3 font-bold uppercase tracking-widest text-xs hover:bg-gray-800 transition-colors">
                    Ver colecci√≥n
                </a>
            </div>
            <div class="order-1 md:order-2 h-full min-h-[300px] relative">
                 <img src="/assets/exclusive-promo.jpg" alt="√âclat Collection" class="absolute inset-0 w-full h-full object-cover" />
            </div>
         </div>
      </div>
  </section>

  {/* 6. SERVICES MOSAIC */}
  <section class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8 py-16 border-t border-gray-100">
     <h2 class="text-center text-2xl font-bold uppercase tracking-widest mb-12">Servicios √âclat</h2>
     <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
        {[
            { title: 'Tarjeta Regalo', icon: 'üéÅ', desc: 'El regalo perfecto' },
            { title: 'App √âclat', icon: 'üì±', desc: 'Descarga nuestra App' },
            { title: 'Brow Bar', icon: 'üëÅÔ∏è', desc: 'Servicio de cejas' },
            { title: 'Maquillaje', icon: 'üíÑ', desc: 'Servicios en tienda' },
        ].map(service => (
            <div class="text-center group cursor-pointer hover:bg-gray-50 p-4 rounded-lg transition-colors">
                <div class="text-4xl mb-4 group-hover:scale-110 transition-transform duration-300">{service.icon}</div>
                <h3 class="font-bold uppercase tracking-widest text-sm mb-2">{service.title}</h3>
                <p class="text-xs text-gray-500">{service.desc}</p>
            </div>
        ))}
     </div>
  </section>

  {/* 8. TRUST SIGNALS */}
  <section class="bg-black text-white py-8">
      <div class="max-w-[1920px] mx-auto px-4 sm:px-6 lg:px-8">
          <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center divide-x divide-gray-800">
            <div>
                <p class="font-bold uppercase tracking-widest text-xs mb-1">Env√≠o Gratis</p>
                <p class="text-[10px] text-gray-400">En pedidos +30‚Ç¨</p>
            </div>
             <div>
                <p class="font-bold uppercase tracking-widest text-xs mb-1">Muestras Gratis</p>
                <p class="text-[10px] text-gray-400">3 muestras en cada pedido</p>
            </div>
             <div>
                <p class="font-bold uppercase tracking-widest text-xs mb-1">Devoluciones</p>
                <p class="text-[10px] text-gray-400">Gratuitas y sencillas</p>
            </div>
             <div>
                <p class="font-bold uppercase tracking-widest text-xs mb-1">Click & Collect</p>
                <p class="text-[10px] text-gray-400">Recogida en tienda 2h</p>
            </div>
          </div>
      </div>
  </section>

</PublicLayout>

<style>
  /* Hide scrollbar for Product Slider */
  .scrollbar-hide::-webkit-scrollbar {
      display: none;
  }
  .scrollbar-hide {
      -ms-overflow-style: none;  /* IE and Edge */
      scrollbar-width: none;  /* Firefox */
  }
</style>
